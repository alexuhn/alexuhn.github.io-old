---
title: "[모두의 네트워크]5장 네트워크 계층"
excerpt: "네트워크 계층의 역할, IP와 서브넷, 라우터에 대하여"
categories:
  - book_notes
tags:
  - 모두의_네트워크
---

# 네트워크 계층의 역할

**데이터 링크 계층**

- 이더넷 규칙을 기반으로 데이터의 전송을 담당
- 같은 네트워크로는 데이터를 전송할 수 있지만, 인터넷이나 다른 네트워크로의 전송은 불가
- 랜에서는 MAC 주소만으로 통신 가능

**네트워크 계층**

- 서로 다른 네트워크 간 통신을 위한 경로 설정을 위해 라우팅을 하며 패킷 전송을 담장
  - **라우팅**: 목적지 IP 주소까지 어떤 경로로 데이터를 보낼지 결정하는 것
- **라우터** 이용
  - 라우터: 목적지까지 어떤 경로를 이용하는 게 좋을지 알려주는 기능
  - **라우팅 테이블**: 경로 정보를 등록 및 관리
- 네트워크를 식별할 수 있는 **IP 주소 필요**

# IP(Internet Protocol)

- 인터넷에 있는 한 컴퓨터에서 다른 컴퓨터로 데이터를 보내는 데 사용하는 네트워크 계층 프로토콜
- IP 주소는 데이터를 다른 네트워크로 전달하기 위해 필요하다.

## IP 헤더

- 네트워크 계층에서 캡슐화 시 IP 헤더 부착
- 버전, 헤더 길이, 서비스 유형, 전체 패킷 길이, ID(일련번호), 조각 상태(flags), 조각의 위치(fragment offset), TTL, 프로토콜, 헤더 체크섬, **출발지 IP 주소**, **목적지 IP 주소** 순서로 구성
- IP 패킷: IP 헤더가 추가된 데이터
  - 데이터 링크 계층에선 프레임이란 용어를 사용

## IP 주소

- 컴퓨터 네트워크에서 장치를 서로 인식하고 통신하기 위해 사용하는 주소
- ISP가 부여
- 32비트를 8비트씩 옥텟으로 나눈 뒤 10진수로 표시
  - 11000000 10101000 00000001 00001010 ⇒ 192 168 1 10
  - 실제 IP 주소는 2진수로 되어있다.
  - 참고로 MAC은 48비트를 16진수로 표시한다.
- **네트워크 ID**와 **호스트 ID**로 나뉨

## IPv4와 IPv6

- IPv4(Internet Protocol version 4)
  - **32비트**의 IP 주소
  - 약 43억 개의 IP 주소를 만들 수 있지만 현재는 충분하지 않아 IPv6 사용
- IPv6(Internet Protocol version 6)
  - **128비트**로 구성

### 공인 IP 주소와 사설 IP 주소

IPv4 주소는 수가 적어 두 종류로 주소를 나누어 사용한다.

- 공인 IP 주소
  - ISP가 제공
  - 인터넷에 직접 연결되는 컴퓨터나 라우터에 할당
- 사설 IP 주소
  - 공인 IP 주소를 할당받은 라우터가 구성하는 랜 내에서, 랜의 네트워크 관리자가 할당하거나 라우터의 DHCP 기능으로 자동 할당
    - DHCP(Dynamic Host Configuration Protocol): IP 주소를 자동으로 할당하는 프로토콜
  - 가정의 컴퓨터에 주로 할당된다.
  - 공인 IP 주소를 모든 컴퓨터에 할당하지 않아도 되어 공인 IP 주소를 절약할 수 있다.

## IP 주소 클래스

IP 주소의 네트워크 ID와 호스트 ID는 크기를 유동적으로 조절할 수 있으며, 네트워크 크기는 클래스라는 개념으로 구분된다.

IPv4에서 사용하는 주소 그룹에는 다섯 개의 클래스가 있다.

| 클래스 이름 | 목적                   | 구성                                  |
| ----------- | ---------------------- | ------------------------------------- |
| A 클래스    | 대규모 네트워크 주소   | 8비트 네트워크 ID + 24비트 호스트 ID  |
| B 클래스    | 중형 네트워크 주소     | 16비트 네트워크 ID + 16비트 호스트 ID |
| C 클래스    | 소규모 네트워크 주소   | 24비트 네트워크 ID + 8비트 호스트 ID  |
| D 클래스    | 멀티캐스트 주소        |                                       |
| E 클래스    | 연구 및 특수 용도 주소 |                                       |

- A 클래스
  - 범위: 1.0.0.0~127.255.255.255
    - 1옥텟 범위: 00000001~01111111, 즉 1~127
    - 2~4옥텟 범위: 00000000~11111111, 즉 0~255
  - 최대 호스트 수: 1677만 7214대(24비트 호스트 ID)
- B 클래스
  - 범위: 128.0.0.0~191.255.255.255
    - 1옥텟 범위: 10000000~10111111, 즉 128~191
    - 2~4옥텟 범위: 00000000~11111111, 즉 0~255
  - 최대 호스트 수: 6만 5534대(16비트 호스트 ID)
- C 클래스
  - 범위: 192.0.0.0~223.255.255.255
    - 1옥텟 범위: 11000000~11011111, 즉 192~223
    - 2~4옥텟 범위: 00000000~11111111, 즉 0~255
  - 최대 호스트 수: 254대(8비트 호스트 ID)

IP 주소 범위 내에서 사용할 수 있는 공인 IP 주소의 범위와 사설 IP 주소의 범위는 정해져 있으며, 사설 IP 주소는 절대 공인 IP 주소로 사용할 수 없다.

## 네트워크 주소와 브로드캐스트 주소

두 주소는 컴퓨터나 라우터가 사용하면 안 되는 IP 주소이다.

- 네트워크 주소
  - 호스트 ID가 00000000인 주소
  - 네트워크 전체를 대표하는 주소
    - 전체 네트워크에서 작은 네트워크를 식별하는 데 사용
    - 예) 192.168.1.1~192.168.1.6은 192.168.1.0의 네트워크에 있다.
- 브로드캐스트 주소
  - 호스트 ID가 11111111인 주소
  - 네트워크에 있는 모든 기기에 한 번에 데이터를 전송할 때 사용하는 주소
  - 예) 192.168.1.255로 전송한 데이터는 192.168.1.1~192.168.1.6을 포함한 모든 기기로 송신된다.

참고로 IP 네트워크에 있는 모든 호스트(컴퓨터)로 데이터를 전송하는 것을 브로드캐스트, 한 호스트에서 여러 컴퓨터로 동시에 패킷을 전송하는 것을 멀티캐스트라 한다.

# 서브넷

- 대규모 네트워크(예를 들어 A 클래스)를 작은 네트워크로 분할해 브로드캐스트로 전송되는 패킷의 범위를 줄일 수 있다.
  - 네트워크를 분할하기 위해 IP 주소 구성을 변경하는 작업을 **서브넷팅**, 분할된 네트워크를 **서브넷**이라 한다.
- 더 많은 네트워크를 만들 수 있어 IP 주소를 효과적으로 사용할 수 있다.
- IP 주소의 호스트 ID를 나누어 서브넷 ID로 만들어 네트워크를 분할할 수 있다.
  - **네트워크 ID + 서브넷 ID + 호스트 ID**
  - 서브넷 ID(서브넷 비트): 네트워크 부분을 늘리기 위해 서브넷 마스크로 사용되는 비트

## 서브넷 마스크

- 네트워크 ID와 호스트 ID를 식별해 네트워크 부분만 나타나게 하여 **같은 네트워크인지 판별**하는 마스크
- 프리픽스 표기법은 서브넷 마스크를 슬래시(/비트)로 나타낸다.
- A 클래스의 서브넷 마스크: 11111111 00000000 00000000 00000000
  - 프리픽스 표기법: /8
- B 클래스의 서브넷 마스크: 11111111 11111111 00000000 00000000
  - 프리픽스 표기법: /16
- C 클래스의 서브넷 마스크: 11111111 11111111 11111111 00000000
  - 프리픽스 표기법: /24

# 라우터

- 서로 다른 네트워크를 연결하는 장치
  - 다른 네트워크로 패킷을 전송할 수 있도록 한다.
- 라우터를 사용하면 네트워크를 분리할 수 있다.
  - 스위치와 허브만 있는 네트워크는 모두 동일한 네트워크에 속함
- 다른 네트워크로 데이터를 전송하기 위해선, 컴퓨터의 **기본 게이트웨이(default gateway)를 라우터의 IP 주소로 설정**해야 한다.
  - 이는 네트워크의 출입구를 지정하는 것과 같다.
- 라우팅
  - 경로 정보를 기반으로, 한 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터 전송
  - 경로 정보는 라우팅 테이블에 등록되어 있다.
- 라우팅 테이블
  - 목적지 주소를 목적지에 도달하기 위한 네트워크 노선으로 변환시킬 목적으로 사용
  - 다른 네트워크로 가기 가장 좋은 라우터 정보를 가지고 있다.
  - 라우팅 테이블 등록 방법
    - 수동 등록
      - 소규모 네트워크에 적합
      - 등록과 수정을 관리자가 해야 함
    - 자동 등록
      - 대규모 네트워크에 적합
      - 등록과 수정이 모두 자동으로 이루어짐
- **라우팅 프로토콜**
  - 라우터 간에 라우팅 정보를 교환하기 위한 프로토콜
  - 이를 설정해 라우터 간 경로 정보를 교환하고 그 정보를 라이팅 테이블에 등록
  - RIP, OSPF, BGP 등
